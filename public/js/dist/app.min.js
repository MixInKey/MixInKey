!function(e){$(document).ready(function(){document.getElementById("slider-range");$(".collapsible").collapsible({accordion:!1}),$(".button-collapse").sideNav()}),e.config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"test.html"}),t.html5Mode(!0)}]),angular.module("templates",[])}(angular.module("beatportApp",["beatportService","ngRoute","templates","ui.bootstrap"],["$interpolateProvider",function(e){e.startSymbol("[%"),e.endSymbol("%]")}])),function(e){e.controller("MainController",["$sce","$rootScope","Beatport",function(e,t,n){var r=this;r.tracks={},r.artists={},r.genres={},r.BPM=0,r.tracks.results,r.perPage=30,r.currentPage=0,r.pages=[],r.lastPage=0,r.filtered,r.nbPages,r.query={},r.currentTrack="5500589",r.currentPlayer=e.trustAsResourceUrl("http://embed.beatport.com/player/?id=5500589&type=track"),r.changeTrack=function(t){r.currentPlayer=e.trustAsResourceUrl("http://embed.beatport.com/player/?id="+t+"&type=track"),r.currentTrack=t},r.findGenres=function(){n.getAllGenres().success(function(e){r.genres=e.results}).error(function(e){console.log(e)})},r.search=function(){r.query.page=r.lastPage,n.findTracks(r.query).success(function(e){r.tracks=e;({metadata:e.metadata});console.log(r.tracks)}).error(function(e){console.log(e)})},r.extend=function(e,t){if(count=0,r.lastPage>0)for(var n in t)++count;for(var n in t)e[count]=t[n],++count;return e},r.getMoreTracks=function(){r.lastPage+=150,r.query.page=r.lastPage,r.search()},r["switch"]=function(e){return r.nbPages==e+2&&(console.log("reload"),r.getMoreTracks()),r.currentPage=e-1},r.moreBpm=function(){r.BPM+=r.BPM<100?10:0,r.BPM=r.BPM<=100?r.BPM:100,document.getElementById("bpm-input").MaterialSlider.change(r.BPM)},r.lessBpm=function(){r.BPM-=r.BPM>0?10:0,r.BPM=r.BPM>=0?r.BPM:0,document.getElementById("bpm-input").MaterialSlider.change(r.BPM)},$("#bpm-input").change(function(){r.BPM=parseInt($(this).val())}),r.isActive=function(e){return r.currentPage==e-1},r.getNbPages=function(e,t){return Math.ceil(e/t)},t.$watch(function(){return r.filtered},function(e,t){i=0,angular.forEach(e,function(e){i++});var n=r.getNbPages(i,r.perPage);r.nbPages=n;for(var a=[],i=1;n>=i;i++)a.push(i);r.pages=a,r.currentPage=0},!0)}])}(angular.module("beatportApp")),function(e){function t(){return{restrict:"EA",replace:!0,templateUrl:"Search/results.html"}}function n(){return{restrict:"EA",replace:!0,templateUrl:"Search/form.html"}}e.directive("resultsBlock",t),e.directive("searchForm",n)}(angular.module("beatportApp")),function(e){function t(){return function(e,t){return e?(t=+t,e.slice(t)):void 0}}e.filter("startFrom",t)}(angular.module("beatportApp")),angular.module("beatportService",[]).factory("Beatport",["$http",function(e){var t=window.location.origin;return{getOne:function(n){return e.get(t+"/track/"+n)},getByArtist:function(n){return e.get(t+"/artist/"+n)},getAllGenres:function(){return e.get(t+"/genres")},findTracks:function(n){return console.log(n),e.post(t+"/search/tracks",n)}}}]),angular.module("templates").run(["$templateCache",function(e){e.put("test.html","<h1>Test</h1>"),e.put("Search/form.html",'<div class="container">\n  <div class="form-group form-group-label" ng-init="main.findGenres()">\n    <label for="genre">Genres</label>\n    <select class="form-control" id="genre" ng-model="main.query.genre">\n      <option value="[% genre.id %]" ng-repeat="genre in main.genres">[% genre.name %]</option>\n    </select>\n  </div><br>\n\n  <div class="form-group">\n    <label for="range">BPM</label>\n    <p class="range-field">\n      <input type="range" name="range" min="0" max="100" />\n    </p>\n  </div><br>\n\n  <div class="row chekbox">\n    <div class="col s3">\n      <input type="checkbox" class="filled-in" id="option1" checked="checked" />\n      <label for="option1">Option 1</label>\n    </div>\n    <div class="col s3">\n      <input type="checkbox" class="filled-in" id="option2" checked="checked" />\n      <label for="option2">Option 2</label>\n    </div>\n    <div class="col s3">\n      <input type="checkbox" class="filled-in" id="option3" checked="checked" />\n      <label for="option3">Option 3</label>\n    </div>\n    <div class="col s3">\n      <input type="checkbox" class="filled-in" id="option4" checked="checked" />\n      <label for="option4">Option 4</label>\n    </div>\n  </div><br>\n\n  <!-- Submit -->\n  <div class="button-search bot-space">\n    <a ng-click="main.search()" class="waves-effect waves-light btn"><i class="material-icons left">search</i>Search</a>\n  </div>\n</div>\n'),e.put("Search/results.html",'<div class="result z-depth-1" ng-if="main.tracks.results" >\n	<div class="page-header">\n		<h3>Result</h3>\n	</div><br>\n  <div class="container">\n    <div class="row">\n        <table class="bordered">\n         <thead>\n           <tr>\n               <th data-field="cover">Cover</th>\n               <th data-field="artist">Artist</th>\n               <th data-field="track">Track</th>\n               <th data-field="genre">Genre</th>\n               <th data-field="key">Key</th>\n               <th data-field="bpm">BPM</th>\n               <th data-field="play">Play</th>\n           </tr>\n         </thead>\n         <tbody ng-repeat="track in main.filtered = (main.tracks.results | filter: query ) | startFrom:main.currentPage*main.perPage | limitTo:main.perPage">\n           <tr>\n             <td>\n               <img class="thumbnail" ng-src="[% track.images.medium.url %]">\n             </td>\n             <td>Artist</td>\n             <td>[% track.name %]</td>\n             <td>Genre</td>\n             <td>Key</td>\n             <td>BPM</td>\n             <td>\n               <a id="[% track.id %]" ng-click="main.changeTrack(track.id)"><i class="material-icons">play_circle_filled</i></a>\n             </td>\n           </tr>\n         </tbody>\n       </table>\n    </div>\n    <div class="text-center">\n      <ul class="pagination">\n        <li class="waves-effect"\n          ng-class="main.isActive(i) ? \'active\' : \'\'"\n          ng-click="main.switch(i)"\n          ng-repeat="i in main.pages">\n          <a>[% i %]</a>\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n')}]);